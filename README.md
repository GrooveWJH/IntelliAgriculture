# 智能温室环境控制系统

一个基于 React 和 TypeScript 的智能温室环境控制系统，实现了环境监测、自动控制、数据分析等功能。

## 功能特点

- 🌡️ **实时环境监测**
  - 空气温度、湿度
  - 土壤温度、湿度、pH值、EC值
  - CO2浓度
  - 光照强度

- 🎮 **智能控制系统**
  - 通风系统（Smith预测控制）
  - 加湿系统（模糊控制）
  - 补光系统（PID控制）
  - 灌溉系统（模糊控制）
  - CO2补充系统（PID控制）
  - 遮阳系统（PID控制）

- 📊 **数据管理**
  - 分层存储策略
  - 自动数据降采样
  - 智能数据清理
  - 历史数据分析

## 技术栈

- React 18
- TypeScript 4
- Ant Design 5
- Styled Components
- Dayjs

## 安装

```bash
# 克隆项目
git clone [repository-url]

# 安装依赖
npm install

# 启动开发服务器
npm start
```

## 使用说明

### 1. 实时监控

访问首页可查看所有环境参数的实时数据，包括：
- 当前值
- 变化趋势
- 警戒状态

### 2. 环境控制

在环境控制页面可以：
- 切换自动/手动控制模式
- 调节各系统运行功率
- 查看系统运行状态
- 监控控制效果

### 3. 数据分析

数据分析页面提供：
- 历史数据查询
- 趋势图表显示
- 数据统计分析
- 异常数据标记

### 4. 系统设置

在设置页面可以配置：
- 控制参数
  - PID参数
  - 模糊控制规则
  - Smith预测模型参数
- 警戒阈值
- 数据存储策略
- 系统维护选项

## 控制模型说明

### PID控制器
用于线性系统控制，适用于：
- 补光系统
- CO2控制
- 遮阳系统

配置参数：
```typescript
{
  defaultKp: 0.2,  // 比例系数
  defaultKi: 0.05, // 积分系数
  defaultKd: 0.1,  // 微分系数
  maxIntegral: 100 // 积分限幅
}
```

### 模糊控制器
用于非线性系统控制，适用于：
- 加湿系统
- 灌溉系统

配置参数：
```typescript
{
  membershipRanges: {
    error: [-10, -5, 0, 5, 10],
    errorChange: [-2, -1, 0, 1, 2]
  },
  rules: [
    [0.0, 0.2, 0.4, 0.6, 0.8],
    [0.2, 0.4, 0.6, 0.8, 1.0],
    [0.4, 0.6, 0.8, 1.0, 0.8],
    [0.6, 0.8, 1.0, 0.8, 0.6],
    [0.8, 1.0, 0.8, 0.6, 0.4]
  ]
}
```

### Smith预测控制器
用于大延迟系统控制，适用于：
- 通风系统

配置参数：
```typescript
{
  deadTime: 5,        // 系统死区时间（秒）
  timeConstant: 30,   // 系统时间常数（秒）
  modelGain: 1.2      // 模型增益
}
```

## 数据存储策略

系统采用分层存储策略：
1. 1分钟内：每秒存储一次
2. 1小时内：每分钟存储一次
3. 1天内：每30分钟存储一次
4. 1月内：每小时存储一次

数据库限制：
- 最大大小：100MB
- 自动清理：超过限制时，自动删除最旧数据
- 手动清理：可保留最近一周数据

## 开发说明

### 目录结构

```
src/
├── components/        # 通用组件
├── contexts/         # 上下文管理
├── controllers/      # 控制器实现
├── services/         # 业务服务
├── config/           # 配置文件
├── pages/           # 页面组件
└── types/           # 类型定义
```

### 配置文件

主要配置文件：`src/config/systemConfig.ts`
- 环境参数配置
- 系统响应配置
- 控制模型配置

### 控制器开发

添加新控制器：
1. 在 `controllers/ControlModels.ts` 中实现控制器类
2. 在 `ControllerFactory` 中注册控制器
3. 在 `services/ControlSystem.ts` 中使用控制器

## 贡献指南

1. Fork 项目
2. 创建特性分支
3. 提交改动
4. 发起 Pull Request

## 许可证

MIT 